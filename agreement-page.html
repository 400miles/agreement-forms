<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agreement Signing</title>
<style>
    body {
        font-family: 'Helvetica Neue', Arial, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        padding: 20px;
        margin: 0;
        min-height: 100vh;
    }

    .agreement-form {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        background: #fff;
        border-radius: 8px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .agreement-header {
        text-align: center;
        margin-bottom: 30px;
        padding-bottom: 20px;
        border-bottom: 2px solid #e1e1e1;
    }
    
    .agreement-id {
        background: #f8f9fa;
        padding: 10px;
        border-radius: 5px;
        font-family: monospace;
        font-weight: bold;
        color: #2c5aa0;
        margin: 10px 0;
    }

    /* Email Verification Styles */
    .verification-section {
        background: #e3f2fd;
        border: 2px solid #2196f3;
        border-radius: 8px;
        padding: 25px;
        margin-bottom: 30px;
    }

    .verification-section h2 {
        margin-top: 0;
        color: #1565c0;
        font-size: 24px;
    }

    .verification-step {
        display: none;
    }

    .verification-step.active {
        display: block;
    }

    .code-input {
        font-size: 24px;
        letter-spacing: 10px;
        text-align: center;
        font-family: monospace;
        padding: 15px;
        width: 200px;
        margin: 20px auto;
        display: block;
    }

    .verified-badge {
        background: #4caf50;
        color: white;
        padding: 10px 20px;
        border-radius: 20px;
        display: inline-block;
        margin: 10px 0;
    }

    /* Form sections - initially hidden until verified */
    .main-form-content {
        display: none;
    }

    .main-form-content.unlocked {
        display: block;
        animation: fadeIn 0.5s;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
    
    .form-section {
        margin-bottom: 25px;
        padding: 15px;
        border: 1px solid #e1e1e1;
        border-radius: 5px;
    }
    
    .form-section h3 {
        margin-top: 0;
        color: #333;
        border-bottom: 1px solid #ddd;
        padding-bottom: 8px;
    }
    
    .form-group {
        margin-bottom: 15px;
    }
    
    .form-group label {
        display: block;
        margin-bottom: 5px;
        font-weight: 600;
        color: #555;
    }
    
    .required {
        color: #d32f2f;
    }
    
    .form-control {
        width: 100%;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 14px;
        box-sizing: border-box;
    }
    
    .form-control:focus {
        border-color: #2c5aa0;
        outline: none;
        box-shadow: 0 0 5px rgba(44, 90, 160, 0.3);
    }
    
    .error {
        border-color: #d32f2f !important;
        background-color: #ffebee;
    }
    
    .error-message {
        color: #d32f2f;
        font-size: 12px;
        margin-top: 5px;
        display: none;
    }

    .success-message {
        color: #2e7d32;
        font-size: 14px;
        margin-top: 10px;
    }
    
    .warning-message {
        background-color: #fff3cd;
        border: 1px solid #ffc107;
        color: #856404;
        padding: 10px;
        border-radius: 4px;
        margin-bottom: 15px;
    }

    .info-message {
        background-color: #e3f2fd;
        border: 1px solid #2196f3;
        color: #1565c0;
        padding: 10px;
        border-radius: 4px;
        margin-bottom: 15px;
    }
    
    .btn-primary {
        background-color: #2c5aa0;
        color: white;
        padding: 12px 30px;
        border: none;
        border-radius: 4px;
        font-size: 16px;
        cursor: pointer;
        width: 100%;
        margin-top: 10px;
    }
    
    .btn-primary:hover {
        background-color: #1e3d6f;
    }
    
    .btn-primary:disabled {
        background-color: #ccc;
        cursor: not-allowed;
    }

    .btn-secondary {
        background: white;
        color: #2c5aa0;
        padding: 10px 20px;
        border: 2px solid #2c5aa0;
        border-radius: 4px;
        text-decoration: none;
        display: inline-block;
        margin: 5px;
        cursor: pointer;
        transition: all 0.3s;
    }

    .btn-secondary:hover {
        background: #2c5aa0;
        color: white;
    }
    
    .loading {
        display: none;
        text-align: center;
        margin: 20px 0;
    }
    
    .spinner {
        border: 4px solid #f3f3f3;
        border-top: 4px solid #2c5aa0;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        animation: spin 2s linear infinite;
        margin: 0 auto;
    }
    
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
    
    .completion-success {
        display: none;
        text-align: center;
        padding: 40px;
        background-color: #e8f5e8;
        border-radius: 8px;
        margin-top: 20px;
    }
    
    .completion-success h2 {
        color: #2e7d32;
        margin-bottom: 15px;
    }

    /* Agreement Viewer Styles */
    .agreement-viewer {
        background: #f8f9fa;
        border: 2px solid #2c5aa0;
        border-radius: 5px;
        padding: 15px;
        margin: 15px 0;
    }

    .agreement-viewer-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
        padding-bottom: 10px;
        border-bottom: 1px solid #ddd;
    }

    .agreement-viewer-header h4 {
        margin: 0;
        color: #2c5aa0;
    }

    .viewer-options {
        text-align: center;
        margin: 15px 0;
    }

    .agreement-text {
        background: white;
        padding: 20px;
        border-radius: 4px;
        max-height: 400px;
        overflow-y: auto;
        line-height: 1.6;
        display: none;
        margin-top: 10px;
        border: 1px solid #ddd;
    }

    .agreement-text h4 {
        color: #333;
        margin-top: 20px;
        margin-bottom: 10px;
    }

    .agreement-text p {
        margin: 10px 0;
        color: #555;
    }

    .agreement-text ol, .agreement-text ul {
        margin: 10px 0;
        padding-left: 30px;
    }

    .agreement-text li {
        margin: 5px 0;
    }

    .review-confirmation {
        background: #e8f5e8;
        border: 1px solid #4caf50;
        padding: 10px;
        border-radius: 4px;
        margin-top: 10px;
        display: none;
    }

    .review-confirmation input[type="checkbox"] {
        margin-right: 8px;
    }

    .must-review-notice {
        background: #ffebee;
        border: 1px solid #d32f2f;
        color: #c62828;
        padding: 10px;
        border-radius: 4px;
        margin-top: 10px;
        font-weight: 600;
    }

    @media (max-width: 768px) {
        .btn-secondary {
            display: block;
            width: 100%;
            margin: 5px 0;
        }
    }
</style>
</head>
<body>

<div class="agreement-form">
    <div class="agreement-header">
        <h1 id="agreement-title">Agreement Signing</h1>
        <div class="agreement-id" id="agreement-id-display">
            AGR-2025-1017-0042
        </div>
    </div>

    <!-- STEP 1: Email Verification -->
    <div class="verification-section" id="verification-container">
        <h2>üîí Step 1: Verify Your Email</h2>
        
        <!-- Step 1a: Enter Email -->
        <div class="verification-step active" id="step-enter-email">
            <p>To begin, please enter your work email address. We'll send you a verification code.</p>
            
            <div class="form-group">
                <label for="verification-email">Work Email Address <span class="required">*</span></label>
                <input type="email" id="verification-email" class="form-control" placeholder="your.name@company.com" required>
                <div class="error-message" id="verification-email-error"></div>
            </div>

            <button type="button" class="btn-primary" onclick="sendVerificationCode()" id="send-code-btn">
                Send Verification Code
            </button>
        </div>

        <!-- Step 1b: Enter Code -->
        <div class="verification-step" id="step-enter-code">
            <p>We've sent a 6-digit code to <strong id="display-email"></strong></p>
            <p style="color: #666; font-size: 14px;">Please check your inbox and enter the code below.</p>
            
            <div class="form-group">
                <input type="text" id="verification-code" class="form-control code-input" 
                       placeholder="000000" maxlength="6" pattern="[0-9]{6}">
                <div class="error-message" id="verification-code-error"></div>
            </div>

            <button type="button" class="btn-primary" onclick="verifyCode()" id="verify-code-btn">
                Verify Code
            </button>

            <p style="margin-top: 20px;">
                <button type="button" class="btn-secondary" onclick="resendCode()">
                    Didn't receive code? Resend
                </button>
            </p>
        </div>

        <!-- Step 1c: Verified -->
        <div class="verification-step" id="step-verified">
            <div style="text-align: center;">
                <div class="verified-badge">‚úì Email Verified</div>
                <p class="success-message">Your email has been verified. You can now complete the agreement.</p>
            </div>
        </div>
    </div>

    <!-- MAIN FORM - Hidden until email verified -->
    <div class="main-form-content" id="main-form-content">
        
        <!-- Agreement Review Section -->
        <div class="form-section" style="background: #fafafa;">
            <h3>üìÑ Step 2: Review Agreement</h3>
            <div class="info-message">
                <strong>Important:</strong> Please review the complete agreement before proceeding to sign.
            </div>

            <div class="agreement-viewer">
                <div class="agreement-viewer-header">
                    <h4 id="agreement-type-display">Agreement</h4>
                    <span style="color: #666; font-size: 14px;">Agreement Type</span>
                </div>

                <div class="viewer-options">
                    <button type="button" class="btn-secondary" onclick="toggleAgreementText()">
                        <span class="btn-icon">üìñ</span> Read Full Text
                    </button>
                </div>

                <!-- HTML Agreement Text -->
                <div id="agreement-text" class="agreement-text">
                    <!-- Agreement content loaded dynamically -->
                </div>

                <!-- Review Confirmation Checkbox -->
                <div class="review-confirmation" id="review-confirmation">
                    <label>
                        <input type="checkbox" id="agreement-reviewed" required>
                        I have reviewed and understood the complete agreement terms above
                    </label>
                </div>

                <div class="must-review-notice" id="must-review-notice">
                    ‚ö†Ô∏è You must review the agreement before proceeding
                </div>
            </div>
        </div>

        <form id="agreement-completion-form">
            <!-- Company Information -->
            <div class="form-section">
                <h3>üìã Step 3: Company Information</h3>
                
                <div class="form-group">
                    <label for="company-name">Legal Company Name <span class="required">*</span></label>
                    <input type="text" id="company-name" name="companyName" class="form-control" required>
                    <div class="error-message" id="company-name-error"></div>
                </div>
                
                <div class="form-group">
                    <label for="business-address">Business Address <span class="required">*</span></label>
                    <textarea id="business-address" name="businessAddress" class="form-control" rows="3" required></textarea>
                    <div class="error-message" id="business-address-error"></div>
                </div>
            </div>

            <!-- Authorized Representative -->
            <div class="form-section">
                <h3>üë§ Step 4: Authorized Representative</h3>
                
                <div class="form-group">
                    <label for="signatory-name">Full Name <span class="required">*</span></label>
                    <input type="text" id="signatory-name" name="signatoryName" class="form-control" required>
                    <div class="error-message" id="signatory-name-error"></div>
                </div>
                
                <div class="form-group">
                    <label for="signatory-title">Title/Position <span class="required">*</span></label>
                    <input type="text" id="signatory-title" name="signatoryTitle" class="form-control" required>
                    <div class="error-message" id="signatory-title-error"></div>
                </div>
                
                <div class="form-group">
                    <label for="phone-number">Phone Number</label>
                    <input type="tel" id="phone-number" name="phoneNumber" class="form-control">
                </div>
            </div>

            <!-- Digital Signature -->
            <div class="form-section">
                <h3>‚úçÔ∏è Step 5: Digital Signature</h3>
                
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="terms-agreement" required>
                        <span class="required">*</span> I have read and agree to all terms
                    </label>
                </div>
                
                <div class="form-group">
                    <label for="digital-signature">Type Full Name to Sign <span class="required">*</span></label>
                    <input type="text" id="digital-signature" name="digitalSignature" class="form-control" required>
                    <div class="error-message" id="digital-signature-error"></div>
                    <small style="color: #666;">Must match your name exactly</small>
                </div>
            </div>

            <button type="submit" class="btn-primary" id="submit-button" disabled>Complete Agreement</button>
            <p id="submit-disabled-message" style="text-align: center; color: #d32f2f; margin-top: 10px;">
                Please review the agreement before submitting
            </p>
        </form>
    </div>

    <div class="loading" id="loading-indicator">
        <div class="spinner"></div>
        <p>Processing...</p>
    </div>

    <div class="completion-success" id="completion-success">
        <h2>‚úì Agreement Completed</h2>
        <p><strong>Agreement ID:</strong> <span id="completed-agreement-id"></span></p>
        <p>The executed PDF will be emailed to you shortly.</p>
        <div style="margin-top: 30px;">
            <a href="https://t-innovate.braineet.com/en/g/external/form?braineeTypeUrl=ext-intake-requests" class="btn-primary" style="display: inline-block; text-decoration: none;">
                Continue to Intake Process
            </a>
        </div>
    </div>
</div>

<script>
const CONFIG = {
    API_SEND_CODE: 'https://7eb27a1e3f99e66a8ae45a9d8ca269.15.environment.api.powerplatform.com:443/powerautomate/automations/direct/workflows/4341c3c423ad4186bbbcbf6ec0f54b93/triggers/manual/paths/invoke?api-version=1',
    API_VERIFY_CODE: 'https://7eb27a1e3f99e66a8ae45a9d8ca269.15.environment.api.powerplatform.com:443/powerautomate/automations/direct/workflows/199a3ec089864a5ea6d8006c1a270a2e/triggers/manual/paths/invoke?api-version=1',
    API_SUBMIT_AGREEMENT: 'https://7eb27a1e3f99e66a8ae45a9d8ca269.15.environment.api.powerplatform.com:443/powerautomate/automations/direct/workflows/f22ee6457eb84ca3a32e3f970a3150be/triggers/manual/paths/invoke?api-version=1&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=sCEtdfiLOS_Ull_JD6DG12B23XJinjCk77mXDy8qUIA',
    GENERIC_DOMAINS: ['gmail.com', 'yahoo.com', 'hotmail.com', 'outlook.com', 'aol.com']
};

let verifiedEmail = '';
let verificationToken = '';
let agreementId = '';
let agreementType = 'NDA'; // Default, can be parsed from URL

// Initialize on page load
document.addEventListener('DOMContentLoaded', function() {
    parseURLParameters();
    setupAgreementReview();
});

// Parse URL parameters
function parseURLParameters() {
    const urlParams = new URLSearchParams(window.location.search);
    agreementId = urlParams.get('id') || 'AGR-2025-1017-0042';
    agreementType = urlParams.get('type') || 'NDA';
    
    document.getElementById('agreement-id-display').textContent = agreementId;
    updateAgreementTitle();
}

// Update agreement title based on type
function updateAgreementTitle() {
    const titles = {
        'NDA': 'Mutual NDA Agreement',
        'CompanyHub': 'Innovation Hub Access Agreement',
        'EmployeeHub': 'Innovation Hub Acknowledgement'
    };
    
    document.getElementById('agreement-title').textContent = titles[agreementType] || 'Agreement Signing';
    document.getElementById('agreement-type-display').textContent = titles[agreementType] || 'Agreement';
}

// Setup agreement review tracking
function setupAgreementReview() {
    document.getElementById('agreement-reviewed').addEventListener('change', function() {
        if (this.checked) {
            enableSubmitButton();
        }
    });
}

// Enable submit button
function enableSubmitButton() {
    document.getElementById('submit-button').disabled = false;
    document.getElementById('submit-disabled-message').style.display = 'none';
}

// Send verification code
async function sendVerificationCode() {
    const email = document.getElementById('verification-email').value.trim();
    const errorDiv = document.getElementById('verification-email-error');
    const btn = document.getElementById('send-code-btn');
    
    // Validate email
    if (!email || !email.includes('@')) {
        errorDiv.textContent = 'Please enter a valid email address';
        errorDiv.style.display = 'block';
        return;
    }
    
    // Check for generic domains
    const domain = email.split('@')[1].toLowerCase();
    if (CONFIG.GENERIC_DOMAINS.includes(domain)) {
        errorDiv.textContent = 'Please use your work email. Generic providers not accepted.';
        errorDiv.style.display = 'block';
        return;
    }
    
    errorDiv.style.display = 'none';
    btn.disabled = true;
    btn.textContent = 'Sending...';
    
    try {
        const response = await fetch(CONFIG.API_SEND_CODE, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                email: email,
                agreementId: agreementId
            })
        });
        
        const data = await response.json();
        
        if (data.success) {
            // Show code entry step
            document.getElementById('step-enter-email').classList.remove('active');
            document.getElementById('step-enter-code').classList.add('active');
            document.getElementById('display-email').textContent = email;
            verifiedEmail = email;
        } else {
            errorDiv.textContent = data.message || 'Failed to send code. Please try again.';
            errorDiv.style.display = 'block';
            btn.disabled = false;
            btn.textContent = 'Send Verification Code';
        }
    } catch (error) {
        errorDiv.textContent = 'Connection error. Please try again.';
        errorDiv.style.display = 'block';
        btn.disabled = false;
        btn.textContent = 'Send Verification Code';
    }
}

// Verify code
async function verifyCode() {
    const code = document.getElementById('verification-code').value.trim();
    const errorDiv = document.getElementById('verification-code-error');
    const btn = document.getElementById('verify-code-btn');
    
    if (code.length !== 6 || !/^\d{6}$/.test(code)) {
        errorDiv.textContent = 'Please enter a valid 6-digit code';
        errorDiv.style.display = 'block';
        return;
    }
    
    errorDiv.style.display = 'none';
    btn.disabled = true;
    btn.textContent = 'Verifying...';
    
    try {
        const response = await fetch(CONFIG.API_VERIFY_CODE, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                email: verifiedEmail,
                code: code
            })
        });
        
        const data = await response.json();
        
        if (data.success) {
            verificationToken = data.token;
            
            // Show verified badge
            document.getElementById('step-enter-code').classList.remove('active');
            document.getElementById('step-verified').classList.add('active');
            
            // Unlock main form after brief pause
            setTimeout(() => {
                document.getElementById('main-form-content').classList.add('unlocked');
                loadAgreementText();
                
                // Pre-fill verified email
                document.getElementById('signatory-name').focus();
            }, 1500);
        } else {
            errorDiv.textContent = data.message || 'Invalid code. Please try again.';
            errorDiv.style.display = 'block';
            btn.disabled = false;
            btn.textContent = 'Verify Code';
        }
    } catch (error) {
        errorDiv.textContent = 'Verification failed. Please try again.';
        errorDiv.style.display = 'block';
        btn.disabled = false;
        btn.textContent = 'Verify Code';
    }
}

// Resend code
async function resendCode() {
    document.getElementById('step-enter-code').classList.remove('active');
    document.getElementById('step-enter-email').classList.add('active');
    document.getElementById('send-code-btn').disabled = false;
    document.getElementById('send-code-btn').textContent = 'Send Verification Code';
}

// Toggle agreement text
function toggleAgreementText() {
    const textDiv = document.getElementById('agreement-text');
    
    if (textDiv.style.display === 'none') {
        textDiv.style.display = 'block';
        textDiv.scrollTop = 0;
    } else {
        textDiv.style.display = 'none';
    }
    
    markAgreementAsReviewed();
}

// Mark agreement as reviewed
function markAgreementAsReviewed() {
    document.getElementById('must-review-notice').style.display = 'none';
    document.getElementById('review-confirmation').style.display = 'block';
}

// Load agreement text based on type
function loadAgreementText() {
    const agreementText = document.getElementById('agreement-text');
    
    switch(agreementType) {
        case 'NDA':
            agreementText.innerHTML = getNDAContent();
            break;
        case 'CompanyHub':
            agreementText.innerHTML = getCompanyHubContent();
            break;
        case 'EmployeeHub':
            agreementText.innerHTML = getEmployeeHubContent();
            break;
        default:
            agreementText.innerHTML = getNDAContent();
    }
}

// NDA Agreement Content
function getNDAContent() {
    return `
        <h4>MUTUAL NON-DISCLOSURE AGREEMENT</h4>
        <p><strong>Agreement ID:</strong> ${agreementId}</p>
        
        <p>This Non-Disclosure Agreement (the "Agreement") is by and between T-Mobile USA, Inc. ("T-Mobile") and the person or entity identified in the digital Submission to which these Non-Disclosure Terms and Conditions are linked (such person or entity, "NDA Party").</p>

        <h4>1. Purpose</h4>
        <p>The parties desire to exchange information on a confidential basis related to an actual or potential business relationship or activities (the "Purpose"). "Confidential Information" means all non-public information or materials, including information and materials disclosed prior to or after the date of this Agreement, that are marked as confidential, orally described as confidential, or should reasonably be understood to be confidential. However, Confidential Information does not include anything that (i) was previously known to the receiving party without any confidentiality obligation, (ii) is or becomes publicly known through no wrongful act of the receiving party, (iii) was rightfully received from a third party without any confidentiality obligation to that third party, or (iv) was independently developed by the receiving party without using any Confidential Information.</p>

        <h4>2. Nondisclosure and Limited Use Obligations</h4>
        <p>Each party will protect Confidential Information disclosed by the other party by (i) not disclosing it to third parties, (ii) preserving its confidentiality with the same level of care it applies to its own similar types of Confidential Information, and always by taking reasonable steps to preserve confidentiality, and (iii) using it only for the Purpose. A party will disclose the other party's Confidential Information only to its employees, affiliates and consultants who need to know such information. A party is responsible for any disclosure or misuse of Confidential Information by its employees, affiliates or consultants.</p>

        <h4>3. Legally-Required Disclosures</h4>
        <p>A receiving party may, without breaching this Agreement, disclose Confidential Information disclosed by the other party to the extent required to comply with a court order or applicable law or regulation. If a receiving party becomes subject to such a requirement, it must notify the disclosing party as soon as possible and, in any case, before it makes the required disclosure (if such notice is allowed) and it must cooperate with the disclosing party (if requested, and at the disclosing party's expense) to seek a protective order or similar protection for its Confidential Information. The receiving party will disclose only such information as is legally required and will use commercially reasonable efforts to obtain confidential treatment for any Confidential Information that is so disclosed.</p>

        <h4>4. Injunctive Relief</h4>
        <p>Each party acknowledges that money damages may not adequately protect the disclosing party against actual or threatened breach of this Agreement and that such breach would result in irreparable harm to the disclosing party. Because of this, a disclosing party may pursue injunctive relief to protect its Confidential Information in any court of competent jurisdiction, without having to post bond or guarantee. The party who has breached or threatened to breach this Agreement will not raise the defense of an adequate remedy at law. This provision does not alter any other remedies available to either party.</p>

        <h4>5. Length of Obligations</h4>
        <p>This Agreement takes effect when both T-Mobile and NDA Party have signed and will continue until either party elects to terminate with thirty (30) days prior written notice to the other party. In the event that a definitive agreement is entered into by the parties, and such definitive agreement includes provisions that conflict with provisions contained herein, then the provisions of the definitive agreement control with regard to the subject matter contained therein. This Agreement applies to any Confidential Information disclosed while it is in effect, and it will apply to all such Confidential Information for a period of five (5) years from its disclosure, regardless of any termination of this Agreement, except this Agreement will apply indefinitely to trade secret information and personal or customer information.</p>

        <h4>6. Other Terms</h4>
        <p>Each party will comply with all applicable laws and regulations, including but not limited to, data privacy, sanctioned persons and export, in the disclosure and use of Confidential Information. The disclosing party does not grant, under this Agreement, any rights under its patents, copyrights, trademarks or other proprietary rights. The disclosing party does not make any representation or warranty (whether express, implied or statutory) under this Agreement regarding any Confidential Information it discloses. The NDA Party shall not access T-Mobile's wireless or wireline network, systems that support U.S. Lawful Process or systems that store customer information. This Agreement does not create any formal business association between the parties, nor any obligation to buy, sell or otherwise transact in any products or services. If a party transfers this Agreement, including as part of a change of control, it will not disclose Confidential Information disclosed by the other party to its transferee unless it has received the disclosing party's express written approval. The laws of the State of Washington, USA (without their conflict of laws principles) govern this Agreement. The parties agree to submit to the jurisdiction of any state court sitting in King County, Washington or any federal court seated in Seattle, Washington. No failure or delay in enforcing any right will be deemed a waiver. This Agreement may be changed only in a writing signed by both parties. If any term of this Agreement is deemed illegal or otherwise unenforceable, that term will be severed and the rest of this Agreement will remain in full force and effect. With the exception of any separate agreement that references this Agreement, this Agreement is the entire agreement between the parties on disclosure and use of Confidential Information, and it supersedes any other negotiations, communications or agreements on those topics.</p>

        <h4>SIGNATURES</h4>
        <p>IN WITNESS HEREOF, the Parties have entered into this Agreement as of the date that opt-in to the terms and conditions via the T-Mobile Innovation intake process.</p>
        
        <p style="font-size: 12px; color: #666; margin-top: 20px;">Version: 09.10.24</p>
        
        <p style="margin-top: 30px;"><strong>By completing and submitting this form, the authorized representative of NDA Party agrees to be bound by all terms and conditions set forth in this Agreement.</strong></p>
    `;
}

// Company Hub Agreement Content
function getCompanyHubContent() {
    return `
        <h4>INNOVATION HUB ACCESS AND PARTICIPATION AGREEMENT</h4>
        
        <p>This Innovation Hub Access and Participation Agreement (this "Agreement") is entered into between <strong>T-Mobile USA, Inc.</strong>, a Delaware corporation ("T-Mobile"), having its principal place of business at 12920 SE 38th Street, Bellevue, WA, 98006, U.S.A., and the Participant company identified below.</p>
        
        <p><strong>Agreement ID:</strong> ${agreementId}</p>
        <p><strong>Effective Date:</strong> Upon execution by all parties</p>

        <h4>1. OVERVIEW</h4>
        <p>T-Mobile operates a technology innovation center consisting of a lab facility ("Innovation Hub"). Participant acknowledges that its use of the Innovation Hub is subject to the terms and conditions of this Agreement, and that use of the Innovation Hub is limited to the date(s) and time(s) determined by T-Mobile in its sole discretion. Before entry into the Innovation Hub, each Participant's employee and representative who will enter the Innovation Hub must sign and return to T-Mobile an Innovation Hub Access and Participation Acknowledgement and adhere to its terms and conditions while in the Innovation Hub.</p>

        <h4>2. APPLICABILITY OF EXISTING T-MOBILE AGREEMENT TERMS</h4>
        <p>If T-Mobile and Participant have an existing agreement for the provision of services or products, and there is a conflict between the terms of that existing agreement, or any order or statement of work under that existing agreement, and the terms of this Agreement, this Agreement will control for the subject matter contained herein, unless otherwise expressly stated. Where there is no conflict between the terms of an existing agreement with T-Mobile and this Agreement, this Agreement has no force or bearing on the terms of the existing agreement, and vice versa.</p>

        <h4>3. TERM OF THE AGREEMENT; TERMINATION</h4>
        <p>This Agreement will commence on the Effective Date and will continue for a term of two years ("Term"), unless terminated earlier by T-Mobile in accordance with this Section. T-Mobile may terminate this Agreement at any time, with or without cause, effective immediately upon written notice to Participant.</p>

        <h4>4. GRANT OF RIGHT TO USE</h4>
        <p>Participant's right to use any portion of the Innovation Hub at any time is granted in writing by T-Mobile pursuant to this Agreement. The specific Right to Use granted to Participant by T-Mobile will detail (a) which specific portions of the Innovation Hub are to be accessible by Participant; and (b) the specific length of time for which the Right to Use is granted. Participant may request an extension of the Term. T-Mobile reserves the right to decline any Participant's request to extend the period of time of the Right to Use.</p>

        <h4>5. RESTRICTIONS ON USE; NON-EXCLUSIVE; LIMITED SPACE</h4>
        <p>Participant understands, acknowledges, and agrees that:</p>
        <ol type="a">
            <li>T-Mobile reserves the right to issue credentials, including but not limited to access cards, in order to control access to or control activities in the Innovation Hub. Under no circumstances will Participant permit its personnel to share or loan the credentials provided by T-Mobile. T-Mobile has the right at any time and for any reason to cancel or revoke credentials previously issued to Participant personnel.</li>
            <li>T-Mobile has the sole right to, at any time and for any length of time: (i) reserve exclusive or other use of the Innovation Hub or any part thereof; (ii) limit Participants use of the Innovation Hub to specific areas and assets; (iii) deny access and use of the Innovation Hub to any person or organization at any time; or (iv) close the Innovation Hub or any part thereof.</li>
            <li>T-Mobile reserves the right to operate a "reservation system" in order to schedule and organize access to and control activities in the Innovation Hub.</li>
            <li>Participant will not have exclusive or private use of the Innovation Hub and there may be third parties in the Innovation Hub during Participant's scheduled time.</li>
            <li>Participant is limited to, and shall only use, the spaces and assets in the Innovation Hub that are allocated to Participant by T-Mobile, and only at the times allocated to Participant by T-Mobile.</li>
            <li>If Participant is collaborating with a third party and wishes to have the third party enter into the Innovation Hub, Participant must communicate to the third party that such third party must contact T-Mobile to obtain access. Participant is responsible for any unauthorized access to the Innovation Hub.</li>
        </ol>

        <h4>6. NO T-MOBILE WARRANTIES</h4>
        <ol type="a">
            <li>Participant's access to the Innovation Hub, use of all equipment and tools, and all feedback provided by T-Mobile employees is provided <strong>"AS IS"</strong>, and T-Mobile makes no warranties, express or implied, and hereby disclaims all implied warranties, including any warranties of merchantability, non-infringement, and fitness for a particular purpose.</li>
            <li>T-Mobile makes no representations or warranties of any kind regarding Participant's privacy while in the Innovation Hub or the confidentiality of the project Participant brings into the Innovation Hub. Participant acknowledges and agrees that Participant has no expectation of privacy or confidentiality regarding Participant's project or activities during use of the Innovation Hub.</li>
        </ol>

        <h4>7. INNOVATION HUB PERSONNEL</h4>
        <p>Participant acknowledges and agrees that:</p>
        <ol type="a">
            <li>T-Mobile and its employees, including Innovation Hub personnel, will not supervise or closely monitor Participant's use of the Innovation Hub space, equipment, and tools;</li>
            <li>Participant agrees that it is solely responsible for Participant's use of the space, equipment, and tools; and</li>
            <li>T-Mobile Innovation Hub personnel are available to provide technical expertise and support, but are under no obligation to provide specific information, skills, or knowledge.</li>
        </ol>

        <h4>8. PURPOSE OF INNOVATION HUB; TERMS OF AGREEMENT</h4>
        <p>Participant understands, acknowledges, and agrees that:</p>
        <ol type="a">
            <li>The Innovation Hub is an open and collaborative space for use by T-Mobile and third parties, including third parties that may be Participant's competitors, in the development of wireless technology and solutions that grow various technology ecosystems;</li>
            <li>This Agreement is between T-Mobile and Participant only and that the rights, remedies, and obligations hereunder do not extend to any third party; and</li>
            <li>The terms of this Agreement are confidential, and Participant will not disclose these terms to any third party.</li>
        </ol>

        <h4>9. INTELLECTUAL PROPERTY; FEEDBACK</h4>
        <p>Participant understands, acknowledges, and agrees that:</p>
        <ol type="a">
            <li>Participant's use of the Innovation Hub does not affect Participant's ownership of Participant's project, and signing this Agreement does not convey any rights in, grant any license to, or give ownership of Participant's project to T-Mobile or any third party;</li>
            <li>Participant's use of the Innovation Hub does not give Participant a right to use, license to, or ownership of any T-Mobile or third-party project, documentation, materials, software, services, products, equipment, or intellectual property;</li>
            <li>For feedback given by Participant to T-Mobile or a third party about the Innovation Hub, tools, equipment, or third-party projects, Participant gives the feedback recipient, without charge, the right to use, share, and commercialize the feedback in any way and for any purpose;</li>
            <li>T-Mobile may independently develop or have developed products or services that are similar to materials and information that Participant brings into the Innovation Hub.</li>
        </ol>

        <h4>10. PARTICIPANT'S WARRANTIES</h4>
        <p>Participant warrants the following:</p>
        <ol type="a">
            <li>Participant owns or has a license to use all materials and information that Participant brings into the Innovation Hub and that Participant's activity will not infringe or violate any third-party rights or violate any applicable laws or regulations;</li>
            <li>Participant's project and any software or product is, and will be at all times, free of computer viruses, Trojan horses, trap doors, worms, or other malicious computer programming routines.</li>
        </ol>

        <h4>11. DAMAGE TO INNOVATION HUB; PERSONAL INJURY</h4>
        <p>Participant will use the Innovation Hub, software, hardware, equipment and tools only in the manner for which they are intended and using best efforts to prevent any loss, destruction, or damage, other than reasonable wear and tear. Participant is responsible for any loss, damage, or destruction it causes to the Innovation Hub and for any personal injury or death that may arise out of Participant's acts or omissions.</p>

        <h4>12. INSURANCE</h4>
        <p>Participant represents that it has a current policy for commercial general liability insurance with limits of liability not less than $1,000,000 per occurrence, combined single limit for bodily injury and property damage, with a $2,000,000 general aggregate.</p>

        <h4>13. INDEMNIFICATION</h4>
        <p>Participant will indemnify, defend, and hold harmless T-Mobile and its affiliates, and their respective officers, directors, employees, agents, contractors and representatives from and against all damages, costs, fees, expenses, and liabilities asserted by a third party to the extent related to: (a) a breach of this Agreement; (b) personal or bodily injury caused during use of the Innovation Hub; (c) property damage or loss caused during use of the Innovation Hub; and (d) Participant's infringement or violation of any intellectual property right or obligation.</p>

        <h4>14. USE OF MARKETING MATERIALS</h4>
        <p>Participant hereby irrevocably grants T-Mobile a royalty-free right to use, distribute, publish, exhibit, digitize, broadcast, display, reproduce, and otherwise exploit Participant's name, trademarks, trade names, or logos in any manner or media whatsoever, anywhere in the world, in perpetuity, for the purpose of advertising, marketing or trade with respect to the Innovation Hub.</p>

        <h4>15. WAIVER AND RELEASE OF CLAIMS</h4>
        <p>Participant will not make any claims against T-Mobile and hereby releases T-Mobile of all claims regarding or resulting from Participant's access to and use of the Innovation Hub, including privacy and confidentiality of Participant's projects, damage or loss of property and personal injury, and T-Mobile's use of marketing materials.</p>

        <h4>16. GOVERNING LAW</h4>
        <p>This Agreement will be governed by the laws of the state of Washington without regard to any rules governing conflicts of laws. The parties consent to the exclusive jurisdiction over and venue in the state and federal courts located in King County, Washington.</p>

        <h4>17. NO BUSINESS ASSOCIATION; NO GUARANTEE OF ACCESS</h4>
        <p>This Agreement does not create any formal business association between the parties, nor any obligation to buy, sell or otherwise transact in any products or services. Nothing in this Agreement obligates T-Mobile to provide access to the Innovation Hub at any time or at a particular time, and T-Mobile may revoke access at any time.</p>

        <h4>SIGNATURES</h4>
        <p><strong>By completing and submitting this form, the authorized representative of Participant agrees to be bound by all terms and conditions set forth in this Agreement.</strong></p>
        
        <p style="font-size: 12px; color: #666; margin-top: 20px;">Version: 01.06.26 | Agreement ID: ${agreementId}</p>
    `;
}

// Employee Hub Agreement Content
function getEmployeeHubContent() {
    return `
        <h4>INNOVATION HUB ACCESS AND PARTICIPATION ACKNOWLEDGEMENT</h4>
        
        <p><strong>Agreement ID:</strong> ${agreementId}</p>
        <p><strong>Effective Date:</strong> Upon acceptance</p>

        <p>By signing this acknowledgement and by requesting access to this Innovation Hub, I acknowledge and agree that:</p>

        <ol>
            <li><strong>Access Times:</strong> I will only enter the Innovation Hub on the date and at the time specified by T-Mobile.</li>

            <li><strong>No Unauthorized Guests:</strong> I will not bring anyone with me to the Innovation Hub who does not have express written approval to enter the Innovation Hub, and I will not use my badge to allow anyone who does not have T-Mobile's express written approval to enter the Innovation Hub.</li>

            <li><strong>Badge Required:</strong> I will not enter the Innovation Hub without using my badge.</li>

            <li><strong>Personnel Present:</strong> I will only enter the Innovation Hub if Innovation Hub personnel are present in the Innovation Hub.</li>

            <li><strong>Personal Items:</strong> I will store personal items such as bags, umbrellas, and coats only in the locker provided for my use.</li>

            <li><strong>Approved Items Only:</strong> I will only bring into the Innovation Hub items required for my approved activities in the space; provided, however I may bring drinks or food into the Innovation Hub but will use the highest standard of care regarding prevention of spills or soiling the space, and I will dispose of all trash before I leave the space.</li>

            <li><strong>Proper Use:</strong> I will use the Innovation Hub, and any provided equipment and tools, only for my approved activities and in the manner for which they are intended.</li>

            <li><strong>Respectful Sharing:</strong> I will make best efforts not to interfere with other occupants' activities, including minimizing the space I use and the clutter I create as much as possible.</li>

            <li><strong>Clean Exit:</strong> I will leave the Innovation Hub in a state at least as clean as it was when I was granted access.</li>

            <li><strong>Restricted Areas:</strong> I will not attempt to gain access to areas of the Innovation Hub to which I have not explicitly been granted access, that are marked as off limits, or that Innovation personnel have verbally informed me during orientation or at any other time are off limits.</li>

            <li><strong>Orientation:</strong> I will participate in an orientation provided by Innovation Hub personnel regarding use of the Innovation Hub, including safety information and use of the space, equipment, and tools, and during my use of the Innovation Hub I will adhere to all information and rules provided during the orientation.</li>

            <li><strong>Emergency Protocols:</strong> I will familiarize myself with the emergency exits and follow all T-Mobile safety and emergency protocols provided in the Innovation Hub, including postings and signage on the walls.</li>

            <li><strong>Personnel Requests:</strong> I will comply with all Innovation Hub personnel requests made and directions given while I am in the Innovation Hub.</li>

            <li><strong>Supervised Equipment:</strong> I understand that certain equipment in the Innovation Hub space requires Innovation Hub personnel approval for use, or supervision during use. Such equipment is clearly labeled, and I will not use that equipment without the required approval or supervision.</li>

            <li><strong>Drone Use:</strong> I understand that I must have approval for drone use from a T-Mobile Innovation Hub drone pilot. Unless a drone pilot gives me explicit approval to fly a drone myself, a drone pilot must fly the drone for me.</li>

            <li><strong>Shared Space:</strong> I understand that the Innovation Hub is an open and collaborative space for use by T-Mobile and third parties, including third parties that may be my competitors, in the development of wireless technology and solutions that grow the wireless ecosystem.</li>

            <li><strong>Non-Exclusive Use:</strong> I understand that I will not have exclusive or private use of the Innovation Hub and there may be third parties in the Innovation Hub during my scheduled time.</li>

            <li><strong>Proper Care:</strong> I will use the Innovation Hub and tools and equipment provided by T-Mobile only in the manner for which they are intended and using best efforts to prevent any destruction or damage, other than reasonable wear and tear resulting from expected use.</li>

            <li><strong>No Removal:</strong> I will not remove T-Mobile or any third-party equipment, tools, or other material from the Innovation Hub without the express permission of T-Mobile or the applicable third party.</li>

            <li><strong>Marketing Rights:</strong> I hereby irrevocably grant T-Mobile, its agents, and others working for it or on its behalf, a royalty-free right to use, distribute, publish, exhibit, digitize, broadcast, display, reproduce, and otherwise exploit my photograph, likeness, voice, name, statements, and testimonials or any material based upon or derived therefrom, in any manner or media whatsoever, anywhere in the world, in perpetuity, for the purpose of advertising, marketing, or trade.</li>

            <li><strong>Ownership:</strong> T-Mobile shall be the sole owner of all right, title, and interest in and to all films, portrayals, photographs, and recordings produced hereunder, including all copyrights therein. If I should receive any print, negative, or other copy thereof, I shall not authorize its use by anyone else.</li>

            <li><strong>No Compensation:</strong> I agree that my participation in any marketing, advertising, or promotional efforts by T-Mobile shall not entitle me to any payment or compensation.</li>
        </ol>

        <h4>ACKNOWLEDGMENT</h4>
        <p><strong>By completing and submitting this form, I acknowledge understanding and acceptance of all terms and conditions set forth in this Acknowledgement.</strong></p>
        
        <p style="font-size: 12px; color: #666; margin-top: 20px;">Version: 01.06.26 | Agreement ID: ${agreementId}</p>
    `;
}

// Form submission
document.getElementById('agreement-completion-form').addEventListener('submit', async function(e) {
    e.preventDefault();
    
    // Check agreement reviewed
    if (!document.getElementById('agreement-reviewed').checked) {
        alert('Please confirm that you have reviewed the agreement.');
        document.getElementById('review-confirmation').scrollIntoView({ behavior: 'smooth' });
        return;
    }
    
    // Validate signature matches name
    const name = document.getElementById('signatory-name').value.trim();
    const signature = document.getElementById('digital-signature').value.trim();
    
    if (name.toLowerCase() !== signature.toLowerCase()) {
        document.getElementById('digital-signature-error').textContent = 'Signature must match your name exactly';
        document.getElementById('digital-signature-error').style.display = 'block';
        return;
    }
    
    // Show loading
    document.getElementById('main-form-content').style.display = 'none';
    document.getElementById('loading-indicator').style.display = 'block';
    
    // Submit to Power Automate
    const formData = {
        agreementId: agreementId,
        agreementType: agreementType,
        verifiedEmail: verifiedEmail,
        verificationToken: verificationToken,
        companyName: document.getElementById('company-name').value,
        businessAddress: document.getElementById('business-address').value,
        signatoryName: name,
        signatoryTitle: document.getElementById('signatory-title').value,
        phoneNumber: document.getElementById('phone-number').value,
        digitalSignature: signature,
        timestamp: new Date().toISOString()
    };
    
    try {
        const response = await fetch(CONFIG.API_SUBMIT_AGREEMENT, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(formData)
        });
        
        if (response.ok) {
            document.getElementById('loading-indicator').style.display = 'none';
            document.getElementById('completed-agreement-id').textContent = agreementId;
            document.getElementById('completion-success').style.display = 'block';
        } else {
            throw new Error('Submission failed');
        }
    } catch (error) {
        alert('Submission error. Please contact support.');
        document.getElementById('loading-indicator').style.display = 'none';
        document.getElementById('main-form-content').style.display = 'block';
    }
});
</script>
</body>
</html>
